# Basic Concepts

## Snapshot
快照捕捉表在某个时间点的状态。用户可以通过最新快照访问表的最新数据。通过时间旅行，用户也可以通过较早的快照访问表以前的状态。

## Partition

Paimon 采用与 Apache Hive 相同的分区概念来分离数据。

分区是根据日期、城市和部门等特定列的值将表划分为相关部分的一种可选方式。每个表可以有一个或多个分区键来标识特定的分区。

通过分区，用户可以对表中的记录进行有效操作。有关如何将文件划分为多个分区，请参阅[file layouts](file-layouts.md)

> 如果定义了主键，分区键必须是主键的子集。如果需要跨分区upsert（主键不包含所有分区字段），则应使用Dynamic Bucket模式。

## Bucket
非分区表或分区表中的分区被细分为桶，以提供额外的数据结构，用于更高效的查询。
桶的范围由记录中一个或多个列的哈希值决定。用户可以通过提供 bucket-key 选项来指定分桶列。
如果没有指定桶键选项，主键（如果已定义）或完整记录将被用作桶键。

桶是读写的最小存储单元，因此桶的数量限制了最大处理并行性。
不过，这个数量也不能太大，否则会导致大量小文件和低读取性能。
一般来说，建议每个存储桶的数据大小在 200MB - 1GB 之间。

请参阅[文件布局](file-layouts.md)了解如何将文件划分为桶。此外，如果要在创建表格后调整桶的数量，请参阅[rescale bucket]()。

## Consistency Guarantees
Paimon 写入程序使用两阶段提交协议，以原子方式将一批记录提交到表中。每次提交时最多产生两个快照。

对于同时修改表的任意两个写入程序，只要它们不修改同一个数据桶，它们的提交就可以并行进行。
如果他们修改了同一个数据桶，则只能保证快照隔离。也就是说，
最终的表状态可能是两次提交的混合体，但不会丢失任何更改。


